{{ define "main" }}

<section class="projects-intro section-white">
  <h1>{{ .Site.Data.projects.intro.title }}</h1>
  <p>
    {{ .Site.Data.projects.intro.text | markdownify }}
  </p>
</section>

<div class="projects-container">

  <!-- Sidebar navigation -->
  <nav class="projects-sidebar">
    <ul>
      {{ range .Site.Data.projects.projects }}
        <li><a href="#{{ .id }}">{{ .name }}</a></li>
      {{ end }}
    </ul>
  </nav>

  <!-- Project content -->
  <article class="projects-main">
    {{ range .Site.Data.projects.projects }}
      <section id="{{ .id }}" class="project-section">
        {{ if .image }}
          <div class="project-with-image">
            <div class="project-float-wrapper">
              <img src="{{ "images/" | relURL }}{{ .image }}" alt="{{ .name }}" class="project-float-icon" />
            </div>
            <div class="project-text">
              <h2>{{ .name }}</h2>
              <p>{{ .description | markdownify }}</p>
            </div>
          </div>
        {{ else }}
          <h2>{{ .name }}</h2>
          <p>{{ .description | markdownify }}</p>
        {{ end }}
      </section>
    {{ end }}
  </article>
  

</div>

<script>
  const sections = document.querySelectorAll(".project-section");
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        history.replaceState(null, "", "#" + entry.target.id);
      }
    });
  }, { threshold: 0.5 });
  sections.forEach((section) => observer.observe(section));
</script>

{{ end }}